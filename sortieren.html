<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title> - Datensätze verbinden</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./kapitel4.html" rel="next">
<link href="./pandas.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><img src="img/logo.png" height="50" alt="logo"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Startseite</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">Über die Website</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./datensatz.html"> 
<span class="menu-text">Über den Datensatz</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./quellen.html"> 
<span class="menu-text">Quellen</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./kapitel1.html">Daten vorbereiten</a></li><li class="breadcrumb-item"><a href="./sortieren.html">Datensätze verbinden</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Einführung</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./kapitel1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Daten vorbereiten</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./einlesen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datensatz einlesen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ueberblick.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datensatz sortieren</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datensatz bereinigen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sortieren.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Datensätze verbinden</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./kapitel4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wahl der Visualisierung</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linePlot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line Charts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./barChart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bar Charts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pieChart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pie Charts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scatterPlot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scatter Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./histogramm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Histogramme</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./boxplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heatmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heatmaps</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Gestaltung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gestaltung</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./achsen_groesse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Achsenanpassungen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formen_linien.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formen und Linien</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./farben.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Farben</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beschriftungen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ueberlappungen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Überlappungen vermeiden</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#verbindungslogik" id="toc-verbindungslogik" class="nav-link active" data-scroll-target="#verbindungslogik">Verbindungslogik</a></li>
  <li><a href="#horizontale-verflechtung" id="toc-horizontale-verflechtung" class="nav-link" data-scroll-target="#horizontale-verflechtung">Horizontale Verflechtung</a></li>
  <li><a href="#vertikale-und-horizontale-verkettung" id="toc-vertikale-und-horizontale-verkettung" class="nav-link" data-scroll-target="#vertikale-und-horizontale-verkettung">Vertikale und horizontale Verkettung</a></li>
  <li><a href="#funktionale-programmierung-verwenden" id="toc-funktionale-programmierung-verwenden" class="nav-link" data-scroll-target="#funktionale-programmierung-verwenden">Funktionale Programmierung verwenden</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./kapitel1.html">Daten vorbereiten</a></li><li class="breadcrumb-item"><a href="./sortieren.html">Datensätze verbinden</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Datensätze verbinden</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In diesem Abschnitt steigen wir in die fortgeschrittene Datenverarbeitung ein. Die Verbindung von Datensätzen in pandas erfolgt nach zwei unterschiedlichen Prinzipien. Entweder können wir die Daten unseres ersten Datensatzes auf die Daten unseres zweiten Datensatzes mappen. Oder wir hängen die Daten des ersten Datensatzes an den zweiten an. Dabei stehen zwei Richtungen zur Verfügung: horizontal (axis=1) und vertikal (axis=0). Die Funktionen merge() mappt die Daten horizontal. Die Funktion concat() hängt die Daten aneinander an. Das kann sie sowohl horizontal als auch vertikal.</p>
<p>Anfangs kann es verwirrend sein, dass horizontale und vertikale Zusammenführung nicht derselben Logik folgen. Während wir mit einem horizontalen merge() in die Struktur der Datensätze eingreifen, hängen wir mit concat() die Datensätze lediglich aneinander an. Eine umfangreiche Dokumentation zu diesem Thema findet sich auf der Website <a href="https://realpython.com/pandas-merge-join-and-concat/">realpython</a>.</p>
<hr>
<section id="verbindungslogik" class="level3">
<h3 class="anchored" data-anchor-id="verbindungslogik">Verbindungslogik</h3>
<p>Aus SQL ist die folgende Verbindungslogik bekannt, die auch bei pandas zur Anwendung kommt, wir sollten sie uns daher gut einprägen:</p>
<p><img src="img/join_sql.jpg" class="img-fluid"></p>
<p>Inner Join liefert einen Dataframe zurück, der lediglich die Daten enthält, die in beiden Datensätzen identisch vorhanden sind. Outer Join dagegen liefert alle Daten zurück. Dadurch entsteht eine Tabelle, die alle Spalten aus beiden Datensätzen enthält. Wenn ein Wert aus dem ersten Datensatz nicht auf den zweiten gemappt werden kann, wird diese Stelle in der Tabelle mit einem NaN-Wert gefüllt. Left und Right Join behalten jeweils einen Teil der Daten und verfahren im Übrigen wie Outer Join.</p>
<hr>
</section>
<section id="horizontale-verflechtung" class="level3">
<h3 class="anchored" data-anchor-id="horizontale-verflechtung">Horizontale Verflechtung</h3>
<p>Die Funktion merge() mappt die Daten des ersten Datensatzes auf die Daten des zweiten. Die “kleine Schwester” von merge() ist die Funktion join(). Diese Funktion ist weniger mächtig, reicht aber für viele Zwecke bereits aus.</p>
<div id="9c57848b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstellen zweier Beispieldatensätze:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>my_df1 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nummer'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'value'</span>: [<span class="st">'Apple'</span>, <span class="st">'Orange'</span>, <span class="st">'Lemon'</span>, <span class="st">'Banana'</span>],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'equal_column'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'df1_column'</span>: [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>my_df2 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'nummer'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'value'</span>: [<span class="st">'Apple'</span>, <span class="st">'Orange'</span>, <span class="st">'Pear'</span>, <span class="st">'Banana'</span> ],</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'equal_column'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>],</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'df2_column'</span>: [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>my_df1.merge(my_df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nummer</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">equal_column</th>
<th data-quarto-table-cell-role="th">df1_column</th>
<th data-quarto-table-cell-role="th">df2_column</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p><br><br> Wie wir sehen, liefert die Funktion einen Dataframe zurück, der nur aus einer einzigen Zeile besteht: die Zeile, in der die Werte identisch sind, denn per default verbindet die Funktion merge() zwei Datensätze als Inner Join. Wir können der Funktion merge() aber auch mitteilen, anhand welcher Spalte sie unsere Dataframes verbinden soll.</p>
<div id="63ac62c7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_df1.merge(my_df2, on<span class="op">=</span> <span class="st">'nummer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nummer</th>
<th data-quarto-table-cell-role="th">value_x</th>
<th data-quarto-table-cell-role="th">equal_column_x</th>
<th data-quarto-table-cell-role="th">df1_column</th>
<th data-quarto-table-cell-role="th">value_y</th>
<th data-quarto-table-cell-role="th">equal_column_y</th>
<th data-quarto-table-cell-role="th">df2_column</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
<td>Orange</td>
<td>B</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>Orange</td>
<td>B</td>
<td>8</td>
<td>Pear</td>
<td>C</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>Lemon</td>
<td>C</td>
<td>9</td>
<td>Banana</td>
<td>D</td>
<td>10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p><br><br></p>
<p>Nun sehen wir, dass wir einen Dataframe zurückgeliefert bekommen, der doppelte Werte enthält. Die ‘nummer’ mit Wert ‘1’ ist zwei Mal vorhanden, da jede der Spalten aus my_df1 auf die Spalten des my_df2 gemappt wurde. Pandas hängt an die Spaltennamen, die in den Dataframes identisch sind, ein _x und _y an. Diese default Werte können wir anpassen, indem wir den Parameter <code>suffixes=['my_suffix1', 'my_suffix2']</code> übergeben.</p>
<p>Als nächstes verbinden wir unsere Dataframes mit einem Outer Join und sehen, dass die Stellen in der Tabelle, für die keine übereinstimmenden Daten gefunden werden können, mit NaN-Werten gefüllt werden.</p>
<div id="a114dadf" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my_df1.merge(my_df2, on<span class="op">=</span> <span class="st">'nummer'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nummer</th>
<th data-quarto-table-cell-role="th">value_x</th>
<th data-quarto-table-cell-role="th">equal_column_x</th>
<th data-quarto-table-cell-role="th">df1_column</th>
<th data-quarto-table-cell-role="th">value_y</th>
<th data-quarto-table-cell-role="th">equal_column_y</th>
<th data-quarto-table-cell-role="th">df2_column</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
<td>Apple</td>
<td>A</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
<td>Orange</td>
<td>B</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>Orange</td>
<td>B</td>
<td>8</td>
<td>Pear</td>
<td>C</td>
<td>9.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>Lemon</td>
<td>C</td>
<td>9</td>
<td>Banana</td>
<td>D</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>Banana</td>
<td>D</td>
<td>10</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<hr>
</section>
<section id="vertikale-und-horizontale-verkettung" class="level3">
<h3 class="anchored" data-anchor-id="vertikale-und-horizontale-verkettung">Vertikale und horizontale Verkettung</h3>
<p>Die Funktion concat() kann Daten sowohl vertikal (axis=0, per default) als auch horizontal (axis=1) verketten. Der Unterschied zu merge() ist jedoch, dass die Daten lediglich angehängt werden. Auch concat() hat eine weniger mächtige “kleine Schwester”, die Funktion append().</p>
<p>Die Funktion concat() konkateniert zwei Dataframes. Sie erweitert also unsere Tabelle und hängt den zweiten Dataframe an den ersten an.</p>
<div id="b6d99b91" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># durch ignore_index=True wird der Index neu gesetzt</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pd.concat([my_df1, my_df2], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nummer</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">equal_column</th>
<th data-quarto-table-cell-role="th">df1_column</th>
<th data-quarto-table-cell-role="th">df2_column</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Orange</td>
<td>B</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Lemon</td>
<td>C</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Banana</td>
<td>D</td>
<td>10.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>NaN</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>Orange</td>
<td>B</td>
<td>NaN</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2</td>
<td>Pear</td>
<td>C</td>
<td>NaN</td>
<td>9.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>3</td>
<td>Banana</td>
<td>D</td>
<td>NaN</td>
<td>10.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p><br><br></p>
<p>Wir können die Funktion concat() auch mit einem Inner Join verwenden, dadurch werden nur die Zeilen und Spalten zurückgeliefert, für die identische Werte in beiden Dataframes existieren.</p>
<div id="504a7a29" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pd.concat([my_df1, my_df2], join<span class="op">=</span><span class="st">'inner'</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nummer</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">equal_column</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Orange</td>
<td>B</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Lemon</td>
<td>C</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Banana</td>
<td>D</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>Orange</td>
<td>B</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2</td>
<td>Pear</td>
<td>C</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>3</td>
<td>Banana</td>
<td>D</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p><br><br></p>
<p>Wir können eine merge ähnliche Ansicht durch die horizontale Verkettung erwirken, aber auch hier werden die Daten lediglich angehängt und nicht gemapped.</p>
<div id="964522d0" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pd.concat([my_df1, my_df2], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nummer</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">equal_column</th>
<th data-quarto-table-cell-role="th">df1_column</th>
<th data-quarto-table-cell-role="th">nummer</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">equal_column</th>
<th data-quarto-table-cell-role="th">df2_column</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
<td>1</td>
<td>Apple</td>
<td>A</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Orange</td>
<td>B</td>
<td>8</td>
<td>1</td>
<td>Orange</td>
<td>B</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Lemon</td>
<td>C</td>
<td>9</td>
<td>2</td>
<td>Pear</td>
<td>C</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Banana</td>
<td>D</td>
<td>10</td>
<td>3</td>
<td>Banana</td>
<td>D</td>
<td>10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<hr>
</section>
<section id="funktionale-programmierung-verwenden" class="level3">
<h3 class="anchored" data-anchor-id="funktionale-programmierung-verwenden">Funktionale Programmierung verwenden</h3>
<p>In unserem Beispiel möchten wir nun einen demographischen Datensatz (df2) mit unserem Right-Wing-Terrorism and Violence-Dataset (df1) verbinden. Wir möchten noch eine weitere Spalte an die Tabelle anfügen, die für jedes Jahr und für jedes Land die entsprechende Einwohnerzahl auflistet.<br>
Schauen wir uns zunächst beide Datensätze an:</p>
<div id="b4cf4c22" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.read_excel(<span class="st">'2023-rtv-1990-2022_without-sources.xlsx'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># die Daten im zweiten Datensatz liegen als Tab Separated Value vor. Diese Information geben wir beim Einlesen an.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_csv(<span class="st">'democraphics_2014-2023.tsv'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>) </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">geo</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">2022</th>
<th data-quarto-table-cell-role="th">2023</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Austria</td>
<td>8507786</td>
<td>8584926</td>
<td>8700471</td>
<td>8772865</td>
<td>8822267</td>
<td>8858775</td>
<td>8901064</td>
<td>8932664</td>
<td>8978929</td>
<td>9104772</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Belgium</td>
<td>11180840</td>
<td>11237274</td>
<td>11311117</td>
<td>11351727</td>
<td>11398589</td>
<td>11455519</td>
<td>11522440</td>
<td>11554767</td>
<td>11617623</td>
<td>11742796</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Swizerland</td>
<td>8139631</td>
<td>8237666</td>
<td>8327126</td>
<td>8419550</td>
<td>8484130</td>
<td>8544527</td>
<td>8606033</td>
<td>8670300</td>
<td>8738791</td>
<td>8815385</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Germany</td>
<td>80767463</td>
<td>81197537</td>
<td>82175684</td>
<td>82521653</td>
<td>82792351</td>
<td>83019213</td>
<td>83166711</td>
<td>83155031</td>
<td>83237124</td>
<td>84358845</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Denmark</td>
<td>5627235</td>
<td>5659715</td>
<td>5707251</td>
<td>5748769</td>
<td>5781190</td>
<td>5806081</td>
<td>5822763</td>
<td>5840045</td>
<td>5873420</td>
<td>5932654</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p><br><br> Offensichtlich lassen sich die beiden Datensätze sehr gut über die Spalten ‘country_name’ (df1) und ‘geo’ (df2) verbinden, denn hier besitzen sie identische Werte.</p>
<div id="02165ecf" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># die Werte von df2 sollen nun als neue Spalten rechts an die bestehende Tabelle angehängt werden.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>merged_df <span class="op">=</span> pd.merge(df1, df2, left_on<span class="op">=</span><span class="st">'country_name'</span>, right_on<span class="op">=</span><span class="st">'geo'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mit Hilfe einer Funktion spezifizieren wir: greife nur auf diejenigen Werte in df2 zu, </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># für die in der Spalte 'year' aus df1 ein identischer Wert gefunden wurde.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Zeilen, für die kein Wert gefunden wurde, werden mit 'None' gefüllt.</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_mapped_value(row):</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    column_name <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">'year'</span>])  <span class="co"># Jahr in String umwandeln, um Spaltennamen abzugleichen</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> column_name <span class="kw">in</span> row:</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> row[column_name]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># mit dem Parameter 'axis=1' geben wir an, dass die Werte Reihenweise gemappt werden sollen.</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 'axis=0' würde dagegen die Spalten mappen.</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># anschließend wenden wir die Funktion auf jede Zeile an, </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># um die neue Spalte 'mapped_population' zu erstellen</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>merged_df[<span class="st">'mapped_population'</span>] <span class="op">=</span> merged_df.<span class="bu">apply</span>(get_mapped_value, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Unnötige Spalten entfernen</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>merged_df.drop(columns<span class="op">=</span>[<span class="st">'geo'</span>] <span class="op">+</span> [<span class="bu">str</span>(year) <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2014</span>, <span class="dv">2024</span>)], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>merged_df.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">case_id</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">country_id</th>
<th data-quarto-table-cell-role="th">iso3</th>
<th data-quarto-table-cell-role="th">country_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">city/village</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">grouped_weapon_type_2</th>
<th data-quarto-table-cell-role="th">weapon_description</th>
<th data-quarto-table-cell-role="th">fatal</th>
<th data-quarto-table-cell-role="th">n_killed</th>
<th data-quarto-table-cell-role="th">n_wounded</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">plot_type</th>
<th data-quarto-table-cell-role="th">plot_targeting</th>
<th data-quarto-table-cell-role="th">plot_operational_planning</th>
<th data-quarto-table-cell-role="th">mapped_population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1961</td>
<td>2021-6-21</td>
<td>2021</td>
<td>6</td>
<td>21</td>
<td>2</td>
<td>BEL</td>
<td>Belgium</td>
<td>Flanders</td>
<td>Maasmechelen</td>
<td>Hoge Kempen National Park</td>
<td>...</td>
<td>Explosives</td>
<td>Weapons including a machine gun, a rocket laun...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>COVID-19 related. A 46-year-old Belgian soldie...</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
<td>11554767</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1962</td>
<td>2022-9-28</td>
<td>2022</td>
<td>9</td>
<td>28</td>
<td>2</td>
<td>BEL</td>
<td>Belgium</td>
<td>Flanders</td>
<td>Multiple locations</td>
<td>Multiple locations</td>
<td>...</td>
<td>NaN</td>
<td>100 firearms and a large quantity of ammunition</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Police searched a dozen houses and arrested si...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>11617623</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1963</td>
<td>2018-2-18</td>
<td>2018</td>
<td>2</td>
<td>18</td>
<td>11</td>
<td>LUX</td>
<td>Luxembourg</td>
<td>Luxembourg</td>
<td>Esch-sur-Alzette</td>
<td>Rue des Remparts</td>
<td>...</td>
<td>NaN</td>
<td>Knife</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>According to witnesses, a man addressed severa...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>602005</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1964</td>
<td>2020-2-22</td>
<td>2020</td>
<td>2</td>
<td>22</td>
<td>11</td>
<td>LUX</td>
<td>Luxembourg</td>
<td>Luxembourg</td>
<td>Strassen</td>
<td>Rue des Romains</td>
<td>...</td>
<td>NaN</td>
<td>Material to produce explosives</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>An 18-year-old man was arrested after foreign ...</td>
<td>3.0</td>
<td>6.0</td>
<td>3.0</td>
<td>626108</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1965</td>
<td>2022-9-23</td>
<td>2022</td>
<td>9</td>
<td>23</td>
<td>8</td>
<td>ISL</td>
<td>Iceland</td>
<td>Höfuðborgarsvæðið</td>
<td>Multiple locations</td>
<td>Multiple locations</td>
<td>...</td>
<td>NaN</td>
<td>Firearms, including semi-automatic guns, a tho...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Four right-wing extremists were arrested on su...</td>
<td>3.0</td>
<td>5.0</td>
<td>2.0</td>
<td>376248</td>
</tr>
</tbody>
</table>

<p>5 rows × 35 columns</p>
</div>
</div>
</div>
</div>
<p><br><br> Mit Hilfe einer lambda-Funktion verkürzt sich die Syntax noch einmal erheblich und wird übersichtlicher:</p>
<div id="7ff1e2ce" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>merged_df <span class="op">=</span> pd.merge(df1, df2, left_on<span class="op">=</span><span class="st">'country_name'</span>, right_on<span class="op">=</span><span class="st">'geo'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lamda</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>merged_df[<span class="st">'mapped_value'</span>] <span class="op">=</span> merged_df.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="bu">str</span>(row[<span class="st">'year'</span>])] <span class="cf">if</span> <span class="bu">str</span>(row[<span class="st">'year'</span>]) <span class="kw">in</span> merged_df.columns <span class="cf">else</span> <span class="va">None</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br></p>
<p>Zuletzt können wir uns noch dafür entscheiden die Spalte ‘geo’ aus unserem ‘df2’ zu behalten, um unseren Dataframe übersichtlicher zu machen. In diesem Fall löschen wir alle Spalten aus ‘df2’, außer der ersten.</p>
<div id="248d3e34" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alle Spalten aus 'df2' außer der ersten löschen</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>merged_df.drop(columns<span class="op">=</span>df2.columns[<span class="dv">1</span>:], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>merged_df.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">case_id</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">country_id</th>
<th data-quarto-table-cell-role="th">iso3</th>
<th data-quarto-table-cell-role="th">country_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">city/village</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">weapon_description</th>
<th data-quarto-table-cell-role="th">fatal</th>
<th data-quarto-table-cell-role="th">n_killed</th>
<th data-quarto-table-cell-role="th">n_wounded</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">plot_type</th>
<th data-quarto-table-cell-role="th">plot_targeting</th>
<th data-quarto-table-cell-role="th">plot_operational_planning</th>
<th data-quarto-table-cell-role="th">geo</th>
<th data-quarto-table-cell-role="th">mapped_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1961</td>
<td>2021-6-21</td>
<td>2021</td>
<td>6</td>
<td>21</td>
<td>2</td>
<td>BEL</td>
<td>Belgium</td>
<td>Flanders</td>
<td>Maasmechelen</td>
<td>Hoge Kempen National Park</td>
<td>...</td>
<td>Weapons including a machine gun, a rocket laun...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>COVID-19 related. A 46-year-old Belgian soldie...</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
<td>Belgium</td>
<td>11554767</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1962</td>
<td>2022-9-28</td>
<td>2022</td>
<td>9</td>
<td>28</td>
<td>2</td>
<td>BEL</td>
<td>Belgium</td>
<td>Flanders</td>
<td>Multiple locations</td>
<td>Multiple locations</td>
<td>...</td>
<td>100 firearms and a large quantity of ammunition</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Police searched a dozen houses and arrested si...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Belgium</td>
<td>11617623</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1963</td>
<td>2018-2-18</td>
<td>2018</td>
<td>2</td>
<td>18</td>
<td>11</td>
<td>LUX</td>
<td>Luxembourg</td>
<td>Luxembourg</td>
<td>Esch-sur-Alzette</td>
<td>Rue des Remparts</td>
<td>...</td>
<td>Knife</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>According to witnesses, a man addressed severa...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Luxembourg</td>
<td>602005</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1964</td>
<td>2020-2-22</td>
<td>2020</td>
<td>2</td>
<td>22</td>
<td>11</td>
<td>LUX</td>
<td>Luxembourg</td>
<td>Luxembourg</td>
<td>Strassen</td>
<td>Rue des Romains</td>
<td>...</td>
<td>Material to produce explosives</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>An 18-year-old man was arrested after foreign ...</td>
<td>3.0</td>
<td>6.0</td>
<td>3.0</td>
<td>Luxembourg</td>
<td>626108</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1965</td>
<td>2022-9-23</td>
<td>2022</td>
<td>9</td>
<td>23</td>
<td>8</td>
<td>ISL</td>
<td>Iceland</td>
<td>Höfuðborgarsvæðið</td>
<td>Multiple locations</td>
<td>Multiple locations</td>
<td>...</td>
<td>Firearms, including semi-automatic guns, a tho...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Four right-wing extremists were arrested on su...</td>
<td>3.0</td>
<td>5.0</td>
<td>2.0</td>
<td>Iceland</td>
<td>376248</td>
</tr>
</tbody>
</table>

<p>5 rows × 36 columns</p>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Ra1nbowbacon\.github\.io\/Matplotlib-Tutorial\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./pandas.html" class="pagination-link" aria-label="Datensatz bereinigen">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Datensatz bereinigen</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./kapitel4.html" class="pagination-link" aria-label="Wahl der Visualisierung">
        <span class="nav-page-text">Wahl der Visualisierung</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./impressum.html">
<p>Impressum</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="./datenschutz.html">
<p>Datenschutz</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="./lizenz.html">
<p>Lizenz</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>